"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},1854:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>q,patchFetch:()=>E,requestAsyncStorage:()=>w,routeModule:()=>v,serverHooks:()=>_,staticGenerationAsyncStorage:()=>y});var s={};t.r(s),t.d(s,{POST:()=>f});var a=t(3036),n=t(5736),i=t(5262),o=t(942),u=t(4750),l=t.n(u),c=t(9763),p=t(7426),d=t(304),g=t(5824),m=t(4685),h=t(2911);let x=c.Ry({email:c.Z_().email(),password:c.Z_().min(8)});async function f(e){try{let r=await e.json(),{email:t,password:s}=(0,g.K)(x,r),a=await p.Z.user.findUnique({where:{email:t}});if(!a||!await l().compare(s,a.passwordHash))throw new d.g(401,"Invalid credentials","invalid_credentials");let n=(0,m.fT)({id:a.id,email:a.email}),i=o.NextResponse.json({user:{id:a.id,email:a.email}},{status:200}),u=(0,m.$Q)();return i.cookies.set("access_token",n,u),i}catch(t){let{payload:e,status:r}=(0,h._)(t);return o.NextResponse.json(e,{status:r})}}let v=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"/Users/aryanrathore/Desktop/Myraid/apps/web/src/app/api/auth/login/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:w,staticGenerationAsyncStorage:y,serverHooks:_}=v,q="/api/auth/login/route";function E(){return(0,i.patchFetch)({serverHooks:_,staticGenerationAsyncStorage:y})}},2911:(e,r,t)=>{t.d(r,{_:()=>a});var s=t(304);function a(e){if(e instanceof s.g){let r={error:{code:e.code,message:e.message}};return e.details&&(r.error.details=e.details),{payload:r,status:e.status}}return{payload:{error:{code:"internal_error",message:"Internal server error"}},status:500}}},4685:(e,r,t)=>{t.d(r,{$Q:()=>p,fT:()=>u,mk:()=>c});var s=t(9362),a=t(5388),n=t.n(a),i=t(304);let o=()=>{if(!process.env.JWT_SECRET)throw new i.g(500,"JWT secret not configured","config_error");return process.env.JWT_SECRET},u=e=>{let r=o(),t=process.env.JWT_EXPIRES_IN||"1h";return n().sign(e,r,{expiresIn:t})},l=async()=>{try{let e=await (0,s.cookies)(),r=e.get("access_token")?.value;if(!r)return null;return n().verify(r,o())}catch{return null}},c=async()=>{let e=await l();if(!e)throw new i.g(401,"Unauthorized","unauthorized");return e},p=()=>({httpOnly:!0,secure:"true"===(process.env.COOKIE_SECURE||"true"),sameSite:"lax",maxAge:36e5})},7426:(e,r,t)=>{t.d(r,{Z:()=>a});let s=require("@prisma/client"),a=global.prisma||new s.PrismaClient},304:(e,r,t)=>{t.d(r,{g:()=>s});class s extends Error{constructor(e,r,t="error",s){super(r),this.status=e,this.code=t,this.details=s}}},5824:(e,r,t)=>{t.d(r,{K:()=>a});var s=t(304);let a=(e,r)=>{let t=e.safeParse(r);if(!t.success)throw new s.g(400,"Validation error","validation_error",t.error.flatten());return t.data}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[522,746,692,763,750],()=>t(1854));module.exports=s})();